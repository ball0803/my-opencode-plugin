# init-deep Framework

This directory contains the standalone CLI implementation of the init-deep command. This was the original implementation before it was integrated as a built-in OpenCode command.

## Overview

The init-deep framework automates the generation of AGENTS.md files across your project structure. It analyzes your codebase and creates hierarchical documentation files based on complexity scoring.

## Architecture

```
init-deep-framework/
├── bin/              # Executable scripts
│   └── init-deep     # Main CLI entry point
├── lib/              # Core libraries
│   ├── discovery.js  # Project discovery and analysis
│   ├── scoring.js    # Directory scoring algorithm
│   ├── config.js     # Configuration management
│   └── todowrite.js  # Todo tracking
├── config/           # Configuration files (empty)
├── commands/         # Command implementations (empty)
└── scripts/          # Additional scripts (empty)
```

## Workflow

The framework follows a 4-phase workflow:

1. **Discovery**: Analyze project structure, find files and directories
2. **Scoring**: Score directories based on complexity, file count, and depth
3. **Generation**: Create AGENTS.md files for high-scoring directories
4. **Review**: Validate and clean up generated files

## Usage

### Basic Usage

```bash
# Show help
node scripts/init-deep-framework/bin/init-deep --help

# Generate AGENTS.md files (default mode)
node scripts/init-deep-framework/bin/init-deep

# Update existing files
node scripts/init-deep-framework/bin/init-deep --update

# Create new files only
node scripts/init-deep-framework/bin/init-deep --create

# Dry run (show what would be generated)
node scripts/init-deep-framework/bin/init-deep --dry-run

# Custom configuration
node scripts/init-deep-framework/bin/init-deep --scoring-config custom-scoring.json

# Limit analysis depth
node scripts/init-deep-framework/bin/init-deep --max-depth 3
```

### Configuration

Create a custom scoring configuration file:

```json
{
  "scoring": {
    "depthWeight": 0.3,
    "fileCountWeight": 0.4,
    "complexityWeight": 0.3,
    "minScore": 0.5
  }
}
```

Then run:

```bash
node scripts/init-deep-framework/bin/init-deep --scoring-config my-config.json
```

## Scoring Algorithm

Directories are scored based on:

- **Depth Weight (30%)**: How deep the directory is in the hierarchy
- **File Count Weight (40%)**: Number of files in the directory
- **Complexity Weight (30%)**: File type diversity and test coverage

Only directories with a score >= minScore (default: 0.5) will get AGENTS.md files.

## Output Format

Generated AGENTS.md files follow this structure:

```markdown
# AGENTS.md for <directory>

## Overview

<1-2 sentences about the directory>

## Files

- `file1.ts`
- `file2.js`
- ...

## Structure

**File types**: ts, js
**Testing**: Present/None detected
**Documentation**: Present/None detected

## Notes

- Generated by init-deep command
- Part of <project> project
- Use "/init-deep" to regenerate
```

## Built-in Command vs Standalone Tool

### Built-in Command (Recommended)

```bash
/init-deep
```

**Pros:**
- Integrated with OpenCode
- Better performance
- Real-time progress tracking
- Access to OpenCode tools

**Cons:**
- Requires OpenCode installation

### Standalone Tool

```bash
node scripts/init-deep-framework/bin/init-deep
```

**Pros:**
- Works without OpenCode
- Can be used in CI/CD
- More configurable

**Cons:**
- Slower
- Requires Node.js
- Manual installation

## Migration from Standalone to Built-in

If you're currently using the standalone tool and want to migrate to the built-in command:

1. Install the OpenCode plugin
2. Run `/init-deep` instead of `node scripts/init-deep-framework/bin/init-deep`
3. The built-in command will automatically detect existing AGENTS.md files
4. Remove the standalone framework if no longer needed

## Development

To modify the framework:

```bash
# Install dependencies
npm install commander

# Run tests
node scripts/test/init-deep.test.sh
```

## License

MIT